const int TempPin = A0;   // select the input pin for the potentiometer or temp sensor
int TempValue = 0;        // Initialize temperature value

//Memory pins on Arduino
const int D1 = 10;
const int Q1 = 12;
const int Q11 = 9;

// Variable to store the value read from the input pin
int pinStateC = 0;
int pinStateH = 0;

// Sampling time for memory.
const unsigned long sampleTimeMs = 500;
unsigned long lastTimeMs = 0;

void setup() {
  Serial.begin(9600);
  pinMode(D1, INPUT);
  pinMode(Q1, OUTPUT);
  pinMode(Q11, OUTPUT);
}

void loop() {
 // Keep track of current time
 unsigned long now = millis();
 // if more than x amount of time has passed based on your preset sample time, 
 // calculate how much time has passed since last sample in seconds and 
 // then increase the value of lastime to the time at which you took the last sample
 if (now - lastTimeMs >= sampleTimeMs) {
  float dt = (now - lastTimeMs) / 1000.0;
  lastTimeMs = now;

  float tempF = readTempF();

  // Memory Storage
  // Read the state of the input pin (either HIGH or LOW)
  pinStateC = digitalRead(D1);
  // Write that same state to the output pin
  digitalWrite(Q1, pinStateC);
  digitalWrite(Q11, pinStateC);

  // plot with bounds, setpoint, live input and 
  Serial.print(tempF);        Serial.print(",");
  Serial.print(62);    Serial.print(",");
  Serial.print(72);    Serial.println();
  }
}

// read the value from the sensor with readtemp function
float readTempF() {
  // Arduino reads 0 to 5V on a scale from 0 to 1023
  // TMP36 maps 0째C to 0.500 V and it rises 0.010 V per 1 째C. -> 100째C per 1V increase

  TempValue = analogRead(TempPin);
  // For troubleshooting lets read voltage level
  float TempVolt = TempValue * (5.0 / 1023.0);

  //Convert from volts to 째C
  float TempC = (TempVolt - 0.500) * 100.0;
  float TempF = TempC * 9.0 / 5.0 + 32.0;
  return TempF;
}
